sudo: required

services:
  - docker

language: python
python:
  - '2.7'

install:
  - sudo apt-get install -y graphviz imagemagick
  - pip install git+git://github.com/recast-hep/recast-backend.git@master --process-dependency-links
  - pip install . --process-dependency-links

script:
  - "echo 'events: 100' > ctx.yml"
  - yadage-run -t from-github/testing/busybox-flow workdir rootflow.yml
  - docker build -t lukasheinrich/recast-cap-demo .
  - ./testrunbackend.py rootflow.yml http://physics.nyu.edu/~lh1132/dummycomplex.zip fit.workspace.root,nonexistent,world.txt --no-cleanup -t from-github/testing/busybox-flow
  - find workdirs
  - rm -rf workdirs
  - RECAST_PLUGIN_TRACK=false ./testrunbackend.py rootflow.yml http://physics.nyu.edu/~lh1132/dummycomplex.zip fit.workspace.root,nonexistent,world.txt -t from-github/testing/busybox-flow
  - find /tmp/recast_quarantine
